[supervisord]
nodaemon=true
logfile=/var/log/supervisord.log
pidfile=/var/run/supervisord.pid

[program:api]
directory=/opt/mycousinvinyl/backend
command=uvicorn app.entrypoints.http.main:app --host 0.0.0.0 --port 8000
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr

[program:discogs-service]
directory=/opt/mycousinvinyl/discogs-service
command=uvicorn app.main:app --host 0.0.0.0 --port 8001
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr

[program:outbox-processor]
directory=/opt/mycousinvinyl/backend
command=python -m app.entrypoints.workers.outbox_processor
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr

[program:worker]
directory=/opt/mycousinvinyl/backend
command=python -m app.entrypoints.workers.consumer
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr

[program:activity-bridge]
directory=/opt/mycousinvinyl/backend
command=python -m app.entrypoints.workers.activity_ws_bridge
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr

[program:cache-cleanup]
directory=/opt/mycousinvinyl/backend
command=python -m app.entrypoints.workers.cache_cleanup
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr

[program:pricing-worker]
directory=/opt/mycousinvinyl/backend
command=python -m app.entrypoints.workers.pricing_worker
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr

[program:nginx]
command=nginx -g "daemon off;"
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr
